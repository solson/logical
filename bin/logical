#!/usr/bin/env ruby
require 'logical'

if ARGV[0] == "repl"
  require 'ripl'
  Ripl.start
  exit
end

def ask(prompt)
  print prompt
  gets.chomp
end

context = {}
loop do
  begin
    line = ask('> ')
  rescue StandardError, Interrupt
    puts
    exit
  end

  break if line == 'quit' or line == 'exit'

  begin
    ast = Logical::Parser.parse(Logical::Lexer.lex(line))
    puts ast.inspect + " => " + ast.evaluate(context).inspect
  rescue RLTK::NotInLanguage
    puts 'Line was not in language.'
  rescue Exception => e
    puts e.to_s
  end
end
